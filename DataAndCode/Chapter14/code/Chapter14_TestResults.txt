Chapter 14

Rats
> ndraws <- 2000
> burnin <- 2000
> update(jags_model, burnin)
  |**************************************************| 100%
> jags_output <- coda.samples(jags_model,
+                             variable.names = c('mu_alpha', 'mu_beta'),
+                             n.iter=ndraws)
  |**************************************************| 100%
> jags_df <- ggs(jags_output)
> jags_df %>%
+     group_by(Parameter) %>%
+     summarize(mean = mean(value),
+               sd = sd(value),
+               `2.5%` = quantile(value, .025),
+               median = median(value),
+               `97.5%` = quantile(value, .975))
# A tibble: 2 × 6
  Parameter   mean    sd `2.5%` median `97.5%`
  <fct>      <dbl> <dbl>  <dbl>  <dbl>   <dbl>
1 mu_alpha  243.   2.74  237.   243.    248.  
2 mu_beta     6.19 0.107   5.98   6.19    6.40

> stan_fit <- stan(file = 'Rats.stan', data = data, chains = 3,
+                  init =rep(list(inits), 3))
> stan_df <- ggs(stan_fit) %>%
+     filter(Parameter %in% c('mu_alpha', 'mu_beta'))
> stan_df %>%
+     group_by(Parameter) %>%
+     summarize(mean = mean(value),
+               sd = sd(value),
+               `2.5%` = quantile(value, .025),
+               median = median(value),
+               `97.5%` = quantile(value, .975))
# A tibble: 2 × 6
  Parameter   mean    sd `2.5%` median `97.5%`
  <fct>      <dbl> <dbl>  <dbl>  <dbl>   <dbl>
1 mu_alpha  243.   2.61  237.   243.    248.  
2 mu_beta     6.19 0.108   5.97   6.19    6.39

Conception

> ndraws <- 10000
> burnin <- 5000
> update(jags_model, burnin)
  |**************************************************| 100%
> jags_output <- coda.samples(jags_model,
+                             variable.names = c('mu', 'gamma', 'sigma', 'sigmag', 'R', 'prob'),
+                             n.iter=ndraws)
  |**************************************************| 100%
> jags_df <- ggs(jags_output)
> jags_df %>%
+     group_by(Parameter) %>%
+     summarize(mean = mean(value),
+               sd = sd(value),
+               `2.5%` = quantile(value, .025),
+               median = median(value),
+               `97.5%` = quantile(value, .975))
# A tibble: 12 × 6
   Parameter   mean    sd  `2.5%` median `97.5%`
   <fct>      <dbl> <dbl>   <dbl>  <dbl>   <dbl>
 1 gamma[1]  46.1   6.92  31.9    46.3     58.6 
 2 gamma[2]  58.6   8.57  42.9    58.0     77.1 
 3 gamma[3]  55.5   5.36  45.2    55.4     66.3 
 4 gamma[4]  45.0   7.14  30.6    45.2     58.1 
 5 gamma[5]  62.9   6.31  51.1    62.8     75.4 
 6 gamma[6]  55.2   4.47  46.3    55.1     64.1 
 7 mu        53.9   6.65  40.6    53.9     67.6 
 8 prob       0.961 0.194  0       1        1   
 9 R[1]       0.761 0.540  0.0720  0.651    2.12
10 R[2]       1.44  0.322  0.987   1.40     2.19
11 sigma     16.5   2.21  12.8    16.3     21.5 
12 sigmag    12.2   8.46   1.30   10.5     33.5 

> stan_df <- ggs(stan_fit) 
> stan_df %>%
+     group_by(Parameter) %>%
+     summarize(mean = mean(value),
+               sd = sd(value),
+               `2.5%` = quantile(value, .025),
+               median = median(value),
+               `97.5%` = quantile(value, .975))
# A tibble: 12 × 6
   Parameter   mean    sd `2.5%` median `97.5%`
   <fct>      <dbl> <dbl>  <dbl>  <dbl>   <dbl>
 1 gamma[1]  45.9   6.83  31.8   46.1     58.3 
 2 gamma[2]  58.9   8.68  43.0   58.2     77.4 
 3 gamma[3]  55.6   5.50  44.8   55.5     66.7 
 4 gamma[4]  44.9   6.95  30.9   45.1     57.6 
 5 gamma[5]  63.0   6.17  51.2   63.0     75.3 
 6 gamma[6]  55.2   4.48  46.4   55.2     64.1 
 7 mu        54.0   6.80  40.1   54.0     67.9 
 8 prob       0.970 0.170  0      1        1   
 9 R[1]       0.778 0.542  0.140  0.656    2.15
10 R[2]       1.45  0.312  0.992  1.40     2.18
11 sigma     16.5   2.18  12.9   16.3     21.3 
12 sigmag    12.5   8.37   2.49  10.6     33.6 
